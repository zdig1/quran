class QuranCalculator{constructor(){this.data=null,this.isLoaded=!1,this.pageMap=new Array(605)}async load(){if(this.isLoaded)return this.data;const a=await fetch("data/quran.json",{cache:"force-cache"});if(!a.ok)throw new Error(`HTTP ${a.status}`);return this.data=await a.json(),this.buildPageIndex(),this.isLoaded=!0,this.data}buildPageIndex(){const a=this.pageMap;for(let t=1;t<=604;t++)a[t]={surah:null,hizb:1,juz:1,sajda:!1,isHizbStart:!1,isJuzStart:!1};const{surahs_index:t=[],hizb_index:e=[],juz_index:s=[],sajda_index:r=[]}=this.data||{};t.forEach((t=>{for(let e=t.page_start;e<=t.page_end;e++)a[e].surah={id:t.id,name:t.name,verses_count:t.verses}}));let i=1,n=0;for(let t=1;t<=604;t++)e[n]?.page===t&&(i=e[n].hizb,a[t].isHizbStart=!0,n++),a[t].hizb=i;let u=1;n=0;for(let t=1;t<=604;t++)s[n]?.page===t&&(u=s[n].juz,a[t].isJuzStart=!0,n++),a[t].juz=u;const h=new Set(r.map((a=>a.page)));for(let t=1;t<=604;t++)a[t].sajda=h.has(t)}getPageData(a){if(a=Number(a),!Number.isInteger(a)||a<1||a>604)return null;const t=this.pageMap[a];return t?{page:a,...t}:null}getPageNotifications(a){const t=this.getPageData(a);if(!t)return[];const e=[];return t.isJuzStart&&e.push(`الجزء ${t.juz}`),t.isHizbStart&&e.push(`الحزب ${t.hizb}`),t.sajda&&e.push("سجدة"),e}getAllSurahs(){return(this.data?.surahs_index||[]).map((a=>({...a,verses_count:a.verses})))}getHizbIndex(){return this.data?.hizb_index||[]}hasSajdaInSurah(a){return this.data?.sajda_index?.some((t=>t.sura_id===a))||!1}getFirstSurahForPage(a){const t=this.getPageData(a);return t?.surah?{id:t.surah.id,name:t.surah.name,verses_count:t.surah.verses_count}:null}getHizbForPage(a){return{hizb:this.getPageData(a)?.hizb??1}}getHizbWithPageRange(){const a=this.getHizbIndex();return a.length?a.map(((t,e)=>{const s=a[e+1];return{...t,page_start:t.page,page_end:s?s.page-1:604}})):[]}}window.quranCalculator=new QuranCalculator;